{% extends "admin/base.html" %}

{% block title %}Blog Posts - Admin{% endblock %}
{% block page_title %}‚úçÔ∏è Blog Posts{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="admin-header">
        <h1>Blog Posts</h1>
        <a href="/admin/blog/new" class="btn btn-primary">+ New Post</a>
    </div>
    
    <div class="admin-table-container">
        <table id="blogTable" class="admin-table display responsive nowrap" style="width:100%">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Slug</th>
                    <th>Status</th>
                    <th>Views</th>
                    <th>Published</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for post in posts %}
                <tr>
                    <td>
                        <strong>{{ post.title }}</strong>
                        {% if post.cover_image %}
                        <br><small>Has cover image</small>
                        {% endif %}
                    </td>
                    <td><code>{{ post.slug }}</code></td>
                    <td>
                        {% if post.is_published %}
                        <span style="color: #10b981; font-weight: bold;">‚úì Published</span>
                        {% else %}
                        <span style="color: #f59e0b; font-weight: bold;">üìù Draft</span>
                        {% endif %}
                    </td>
                    <td><strong>{{ post.view_count or 0 }}</strong> üëÅÔ∏è</td>
                    <td>{{ post.published_at.strftime('%Y-%m-%d') }}</td>
                    <td class="table-actions">
                        <a href="/blog/{{ post.slug }}" target="_blank" class="btn btn-sm btn-secondary">View</a>
                        <a href="/admin/blog/{{ post.id }}/edit" class="btn btn-sm btn-secondary">Edit</a>
                        <form method="post" action="/admin/blog/{{ post.id }}/delete" style="display: inline;" onsubmit="return confirm('Are you sure?');">
                            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    $(document).ready(function() {
        $('#blogTable').DataTable({
            responsive: true,
            pageLength: 10,
            order: [[4, 'desc']], // Sort by Published date descending
            language: {
                search: "Search posts:",
                lengthMenu: "Show _MENU_ posts per page",
                info: "Showing _START_ to _END_ of _TOTAL_ posts",
                infoEmpty: "No posts available",
                infoFiltered: "(filtered from _MAX_ total posts)"
            }
        });
    });
</script>
{% endblock %}
